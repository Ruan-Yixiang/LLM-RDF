/*! For license information please see 3.52b5d91.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{V6vp:function(e,t,n){"use strict";n("q0Re")},ZULT:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"root"},[this._m(0),this._v(" "),t("div",{attrs:{id:"canvasPanel"},on:{dragover:function(e){e.preventDefault()}}}),this._v(" "),t("input",{attrs:{id:"canvas-input",type:"text"}})])};r._withStripped=!0;var a=n("fD4D"),o=n("qlJx"),i={data:function(){return{graph:null,node:null,inputEl:null}},mounted:function(){var e=this;document.title="脑图",this.$nextTick((function(){e.createGraphic(),e.initGraphEvent(),e.inputEl=document.getElementById("canvas-input"),e.inputEl.addEventListener("blur",(function(){e.inputEl.style.left="-100em",e.inputEl.style.top="-100em"}))}))},beforeDestroy:function(){this.graph.destroy()},methods:{createGraphic:function(){for(var e=this,t={id:"root",label:"Root",edgeStyle:{stroke:"#999"},children:[{text:"root-note",edgeStyle:{stroke:"#39495b"},preRect:{show:!0,width:4,fill:"#40a9ff",radius:2},logoIcon:{show:!0,x:-92,y:-8,img:"https://gw.alipayobjects.com/zos/basement_prod/4f81893c-1806-4de4-aff3-9a6b266bc8a2.svg",width:16,height:16},stateIcon:{show:!0,x:70,y:10,text:"",fontFamily:"iconfont",fontSize:20,style:{stroke:"#333",fill:"#fc0"}},labels:[{x:-70,y:-10,label:"标题,最长10个字符~~",labelCfg:{maxlength:10,style:{fontSize:14,fill:"#666"}}},{x:-70,y:7,label:"描述,最长12个字符~~~",labelCfg:{maxlength:12,style:{fontSize:12,fill:"#999"}}},{x:-70,y:24,label:"第三行,最长16个字符,超出显示省略号~~~",labelCfg:{maxlength:16,style:{fontSize:10,fill:"#ccc"}}}],children:[{label:"初始化事件和生命周期和其他",labelCfg:{maxlength:10,style:{fill:"#666",stroke:"#ccc"}}}]},{label:"初始化事件和生命周期和其他",labelCfg:{x:16,maxlength:10,style:{fill:"#666",stroke:"#ccc"}},stateIcon:{show:!0,x:-96,y:14,text:"",fontFamily:"iconfont",fontSize:30,style:{stroke:"#999",fill:"#fc0"}},children:[{label:"初始化事件和生命周期和其他",labelCfg:{maxlength:10,style:{fill:"#666",stroke:"#ccc"}}}]}]},n=0;n<11;n++)t.children.push({label:"初始化事件和生命xxx",labelCfg:{maxlength:10,style:{fill:"#666",stroke:"#ccc"}},children:[{label:"初始化事件和生命xxx",labelCfg:{maxlength:10,style:{fill:"#666",stroke:"#ccc"}}}]});var r=Object(o.a)(a.a,{width:window.innerWidth,height:window.innerHeight-40,fitCenter:!0,layout:{type:"mindmap",direction:"H",getWidth:function(){return 200},getVGap:function(){return 50},getHGap:function(){return 50}},modes:{default:["zoom-canvas","drag-canvas","canvas-event","select-node"]},defaultNode:{type:"modelRect-node",labelCfg:{style:{fontSize:14}},anchorControls:{hide:!0}},defaultEdge:{type:"hvh-h-edge",style:{radius:5,offset:15,lineWidth:3,lineAppendWidth:10}},nodeStateStyles:{"nodeState:default":{opacity:1},"nodeState:hover":{opacity:.8},"nodeState:selected":{opacity:.9}},edgeStateStyles:{"edgeState:hover":{animate:!1}}});this.graph=new a.a.TreeGraph(r),this.graph.read(t),setTimeout((function(){e.graph.paint(),e.graph.fitView()}))},initGraphEvent:function(){var e=this;this.graph.on("keydown",(function(t){switch(t.keyCode){case 9:e.tabEvent(t);break;case 13:e.enterEvent(t)}})),this.graph.on("after-node-selected",(function(t){t&&t.item&&(e.node=t.item)})),this.graph.on("canvas:mousedown",(function(t){t&&t.item&&(e.node=null)})),this.graph.on("after-node-dblclick",(function(t){t&&t.item&&(e.node=t.item,e.enterEvent(t))})),this.graph.on("before-edge-add",(function(t){var n=t.source,r=t.target,a=t.sourceAnchor,o=t.targetAnchor;setTimeout((function(){e.graph.addItem("edge",{source:n.get("id"),target:r.get("id"),sourceAnchor:a,targetAnchor:o})}),100)}))},tabEvent:function(e){},enterEvent:function(e){if(this.node&&this.node._cfg.keyShape.cfg){var t=this.node._cfg,n=t.keyShape.cfg.cacheCanvasBBox,r=n.x,a=n.y,o=n.width,i=n.height,s=t.model.label;this.inputEl.style.width="".concat(o,"px"),this.inputEl.style.height="".concat(i,"px"),this.inputEl.style.left="".concat(r,"px"),this.inputEl.style.top="".concat(a+40,"px"),this.inputEl.value=s,this.inputEl.focus()}}}},s=(n("V6vp"),n("KHd+")),c=Object(s.a)(i,r,[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"headPanel"}},[t("span",{staticClass:"logo"},[this._v("脑图 (Tab新建节点, 回车输入和确定)")])])}],!1,null,null,null);c.options.__file="src/pages/tree/tree.vue";t.default=c.exports},eSmK:function(e,t,n){(t=n("JPst")(!1)).push([e.i,"#canvasPanel{left:0}#canvas-input{position:absolute;top:100em;left:100em;z-index:100;border:1px solid #ccc}",""]),e.exports=t},q0Re:function(e,t,n){var r=n("LboF"),a=n("eSmK");"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var o={insert:"head",singleton:!1};r(a,o);e.exports=a.locals||{}},qlJx:function(e,t,n){"use strict";n("HAE/"),n("WLL4"),n("jm62"),n("RW0V"),n("f3/d"),n("Z2Ku"),n("dRSK"),n("0l/t"),n("rGqo"),n("8+KV");var r=n("rePB");n("Vd3H");function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n,r){e.attr(t),n&&n.attr(r)}function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hover",r=t.get("item"),a=t.getFirst().attr(),o="node"===e?r.get("originStyle"):r.get("originStyle")["edge-shape"],i=a["".concat(e,"State:").concat(n)],s=a["".concat(e,"State:default")];return"edge"===e&&s&&null==s.lineWidth&&(s.lineWidth=1),{activeStyle:i,defaultStyle:s,originStyle:o}}var c={anchorShow:function(e,t){if(t.get("children")){var n=t.get("children")[0].cfg.attrs.anchorControls;if(n&&n.hide)return!1}e?t.showAnchor(t):t.clearAnchor(t)},anchorActived:function(e,t){if(t.get("children")){var n=t.get("children")[0].cfg.attrs.anchorControls;if(n&&n.hide)return!1}if(e){var r=t.get("item").getModel(),a=r.anchorPoints,i=r.anchorHotsoptStyles;t.showAnchor(t),this.getAnchorPoints({anchorPoints:a}).forEach((function(e,n){var r=t.get("children")[0].getBBox(),a=t.addShape("circle",{zIndex:0,attrs:o({x:r.minX+r.width*e[0],y:r.minY+r.height*e[1],r:0,opacity:.5,fill:"#1890ff"},i),nodeId:t.get("item").get("id"),className:"node-anchor-bg",draggable:!0,isAnchor:!0,index:n});a.animate({r:11},{duration:200}),t.sort(),t.anchorShapes.push(a)})),t.anchorShapes.filter((function(e){"node-anchor"===e.get("className")&&e.toFront(),"node-anchor-group"===e.get("className")&&(e.attr({r:(i&&i.r||11)+2}),e.toFront())}))}else t.clearAnchor(t)},nodeState:function(e,t){!1===e?c["nodeState:default"].call(this,!0,t):c["nodeState:".concat(e)]&&c["nodeState:".concat(e)].call(this,e,t)},"nodeState:default":function(e,t){if(e){var n=t.getChildByIndex(0),r=t.getChildByIndex(1),a=s.call(this,"node",t).defaultStyle;if(!a)return;i(n,a,r,a.labelCfg&&a.labelCfg.style?a.labelCfg.style:{})}},"nodeState:selected":function(e,t){var n=t.getChildByIndex(0),r=t.getChildByIndex(1),a=s.call(this,"node",t,"selected"),o=a.activeStyle,c=a.defaultStyle;o&&(e?i(n,o,r,o.labelCfg&&o.labelCfg.style?o.labelCfg.style:{}):i(n,c,r,c.labelCfg&&c.labelCfg.style?c.labelCfg.style:{}))},"nodeState:hover":function(e,t){var n=t.getChildByIndex(0),r=s.call(this,"node",t,"hover"),a=r.activeStyle,o=r.defaultStyle;a&&i(n,e?a:o)},edgeState:function(e,t){!1===e?c["edgeState:default"].call(this,!0,t):c["edgeState:".concat(e)]&&c["edgeState:".concat(e)].call(this,e,t)},"edgeState:default":function(e,t){if(e){var n=s.call(this,"edge",t),r=n.activeStyle,a=n.defaultStyle,c=n.originStyle,d=t.getChildByIndex(0),l=d.get("attrs"),h=l.endArrow,g=l.startArrow;a&&(this.stopAnimate(t,r&&r.animationType?r.animationType:"dash"),i(d,o(o({},a),{},{animationType:r.animationType||"dash"})),h&&d.attr("endArrow",!0===h||{path:h.path,fill:a.stroke||c.stroke}),g&&d.attr("startArrow",!0===g||{path:g.path,fill:a.stroke||c.stroke}))}},"edgeState:hover":function(e,t){var n=t.getChildByIndex(0),r=n.get("attrs"),a=r.endArrow,o=r.startArrow,c=s.call(this,"edge",t,"hover"),d=c.activeStyle,l=c.defaultStyle,h=c.originStyle;d&&(e?!0===d.animate?this.runAnimate(t,d.animationType||"dash"):"function"==typeof d.animate?d.animate.call(this,t):(i(n,d),a&&n.attr("endArrow",!0===a||{path:a.path,fill:d.stroke||h.stroke}),o&&n.attr("startArrow",!0===o||{path:o.path,fill:d.stroke||h.stroke})):!0===d.animate?this.stopAnimate(t,d.animationType||"dash"):"function"==typeof d.animate?d.animate.call(this,t,"stop"):(i(n,l),a&&n.attr("endArrow",!0===a||{path:a.path,fill:l.stroke||d.stroke||h.stroke}),o&&n.attr("startArrow",!0===o||{path:o.path,fill:l.stroke||d.stroke||h.stroke})))},"edgeState:selected":function(e,t){var n=t.getChildByIndex(0),r=n.get("attrs"),a=r.endArrow,o=r.startArrow,c=s.call(this,"edge",t,"selected"),d=c.activeStyle,l=c.defaultStyle,h=c.originStyle;d&&(e?!0===d.animate?this.runAnimate(t,d.animationType||"dash"):"function"==typeof d.animate?d.animate.call(this,t):(i(n,d),a&&n.attr("endArrow",!0===a||{path:a.path,fill:d.stroke||h.stroke}),o&&n.attr("startArrow",!0===o||{path:o.path,fill:d.stroke||h.stroke})):!0===d.animate?this.stopAnimate(t,d.animationType||"dash"):"function"==typeof d.animate?d.animate.call(this,t,"stop"):(i(n,l),a&&n.attr("endArrow",!0===a||{path:a.path,fill:l.stroke||d.stroke||h.stroke}),o&&n.attr("startArrow",!0===o||{path:o.path,fill:l.stroke||d.stroke||h.stroke})))}},d=c,l=n("KQm4"),h=[],g=null,u={fill:"#ecf3ff",stroke:"#1890FF",lineWidth:1},f={style:{fontSize:12,fill:"#666",textAlign:"center",textBaseline:"middle",cursor:"default"}},p={width:20,height:20,x:0,y:0},y={r:4,fill:"#fff",stroke:"#1890FF",lineWidth:1};function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m=p,b=u,x=y,w=f;function O(e,t){return v(v(v(v(v(v({},t),b),e),t.style),{},{labelCfg:v(v({},w),t.labelCfg),iconStyles:v(v({},m),t.iconStyles),anchorPointStyles:v(v({},x),t.anchorPointStyles)},t.nodeStateStyles),{},{anchorHotsoptStyles:t.anchorHotsoptStyles})}var k=function(e){e.registerNode("base-node",{getShapeStyle:function(e){var t=e.style.width||80,n=e.style.height||40;return O.call(this,{width:t,height:n,radius:5,x:-t/2,y:-n/2},e)},drawIcon:function(e,t,n){[n.logoIcon,n.stateIcon].forEach((function(e,r){if(e){var a="".concat(n.type,"-").concat(0===r?"logoIcon":"stateIcon"),o=t.$getItem(a);if(!o)t.addShape(e.img?"image":"text",{attrs:v(v({},e),e.style),draggable:!0,className:a}).toFront(),o=t.$getItem(a);o&&(e.show?o.show():o.hide())}}))},initAnchor:function(e,t){var n=this;t.anchorShapes=[],t.showAnchor=function(t){n.drawAnchor(e,t)},t.clearAnchor=function(e){e.anchorShapes&&e.anchorShapes.forEach((function(e){return e.remove()})),e.anchorShapes=[]}},drawAnchor:function(e,t){var n=t.getFirst().attr(),r=n.type,a=n.direction,o=n.anchorPointStyles,i=t.get("children")[0].getBBox(),s=this.getAnchorPoints(e);s&&s.forEach((function(e,n){var s="triangle-node"===r?"up"===a?1:0:.5,c=i.width*(e[0]-.5),d=i.height*(e[1]-s),u=t.addShape("circle",{attrs:v({x:c,y:d},o),zIndex:1,nodeId:t.get("id"),className:"node-anchor",draggable:!0,isAnchor:!0,index:n}),f=t.addShape("circle",{attrs:{x:c,y:d,r:11,fill:"#000",opacity:0},zIndex:2,nodeId:t.get("id"),className:"node-anchor-group",draggable:!0,isAnchor:!0,index:n});!function(e,t,n){e.on("mouseenter",(function(){e.attr({cursor:"crosshair"})})),e.on("dragstart",(function(e){if(null==g){var r=t.getFirst().attr(),a=r.type,o=r.direction,i="triangle-node"===a?"up"===o?1:0:.5,s=t.get("item").getBBox(),c=t.get("item").get("id"),d=[s.width*(n[0]-.5),s.height*(n[1]-i)];h=[e.x,e.y];var l=t.addShape("path",{attrs:{stroke:"#1890FF",lineDash:[5,5],path:[["M"].concat(d),["L"].concat(d)]},className:"dashed-line",pointStart:d});t.toFront(),l.toFront(),g=c}})),e.on("drag",(function(e){var n=t.getFirst().attr(),r=n.type,a=n.direction,o=t.get("children")[0].get("canvasBBox");if(o){var i="triangle-node"===r?"up"===a?o.height:0:o.height/2,s=t.$getItem("dashed-line"),c=s.get("pointStart"),d=[e.x-o.x-o.width/2,e.y-o.y-i];s.toFront(),Math.sqrt(Math.pow(Math.abs(h[0])-Math.abs(e.x),2)+Math.pow(Math.abs(h[1])-Math.abs(e.y),2))>=10&&(e.x>=h[0]?(e.y,h[1],d[0]-=1,d[1]-=1):(e.y,h[1],d[0]+=1,d[1]+=1)),s.attr({path:[["M"].concat(Object(l.a)(c)),["L",d[0],d[1]]]})}})),e.on("dragend",(function(e){t.$getItem("dashed-line").remove(),g=null})),e.on("dragenter",(function(e){if(e.target.cfg.nodeId!==g){var n=e.target.cfg.index;t.getAllAnchorBg()[n]&&t.getAllAnchorBg()[n].attr("fillOpacity",.7)}})),e.on("dragleave",(function(e){if(e.target.cfg.nodeId!==g){var n=e.target.cfg.index;t.getAllAnchorBg()[n]&&t.getAllAnchorBg()[n].attr("fillOpacity",.5)}}))}(f,t,e),t.anchorShapes.push(u),t.anchorShapes.push(f)})),t.getAllAnchors=function(){return t.anchorShapes.filter((function(e){return!0===e.get("isAnchor")}))},t.getAnchor=function(e){return t.anchorShapes.filter((function(t){return"node-anchor"===t.get("className")&&t.get("index")===e}))},t.getAllAnchorBg=function(){return t.anchorShapes.filter((function(e){return"node-anchor-bg"===e.get("className")}))}},addLabel:function(e,t,n){var r=n.label,a=n.labelCfg,o=n.labels;if(o)o.forEach((function(e){var n=e.label,r=e.labelCfg.maxlength,a=e.className,o=r?n.substr(0,r):n||"";n.length>r&&(o="".concat(o,"...")),t.addShape("text",{attrs:v(v(v({text:o},e),e.labelCfg),e.labelCfg.style),className:"node-text ".concat(a),draggable:!0})}));else if(r){var i=a.maxlength,s=i?r.substr(0,i):r||"";r.length>i&&(s="".concat(s,"...")),t.addShape("text",{attrs:v(v({text:s,x:0,y:0},a),a.style),className:"node-text",draggable:!0})}},drawModelRect:function(e,t){var n=t.preRect,r=t.width,a=t.height;n&&!1===n.show||e.addShape("rect",{attrs:v(v({x:-r/2,y:-a/2,height:a},{show:!0,width:4,fill:"#40a9ff",radius:2}),n),draggable:!0})},draw:function(e,t){return this.drawShape(e,t)},drawShape:function(e,t){var n=this.getShapeStyle(e,t),r=t.addShape(this.shapeType,{className:"".concat(this.shapeType,"-shape"),xShapeNode:!0,draggable:!0,attrs:n});return t.$getItem=function(e){return t.get("children").find((function(t){return t.get("className")===e}))},"modelRect-node"===this.type&&this.drawModelRect(t,n),this.addLabel(e,t,n),this.drawIcon(e,t,n),this.initAnchor(e,t),r},update:function(e,t){var n=t.get("model"),r=t.get("keyShape").attrs,a=t.get("group").$getItem("node-text"),o=t.get("group").get("children")[0];a&&a.attr(v({text:n.label},n.labelCfg.style)),o.attr(v(v({},r),n.style))},setState:function(e,t,n){var r=n.getContainer();r.get("destroyed")||(["anchorShow","anchorActived","nodeState","nodeState:default","nodeState:selected","nodeState:hover","nodeOnDragStart","nodeOnDrag","nodeOnDragEnd"].includes(e)?d[e].call(this,t,r):this.stateApplying&&this.stateApplying.call(this,e,t,n))},getAnchorPoints:function(e){return e.anchorPoints||[[.5,0],[1,.5],[.5,1],[0,.5]]}},"single-node")};function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P=p,C=u,E=y,B=f;function M(e,t){return j(j(j(j(j(j({},t),C),e),t.style),{},{labelCfg:j(j(j({},B),t.labelCfg),{},{style:j(j({},B.style),t.labelCfg?t.labelCfg.style:{})}),iconStyles:j(j({},P),t.iconStyles),anchorPointStyles:j(j({},E),t.anchorPointStyles)},t.nodeStateStyles),{},{anchorHotsoptStyles:t.anchorHotsoptStyles})}var D=function(e){k(e),function(e){e.registerNode("rect-node",{shapeType:"rect",getShapeStyle:function(e){var t=e.style.width||80,n=e.style.height||40;return M.call(this,{width:t,height:n,radius:5,x:-t/2,y:-n/2},e)}},"base-node"),e.registerNode("circle-node",{shapeType:"circle",getShapeStyle:function(e){var t=e.style.r||30;return M.call(this,{r:t,x:0,y:0},e)}},"base-node"),e.registerNode("circle-node2",{shapeType:"circle",drawText:function(e){this.addShape("text",{attrs:j({text:e.label},e.label.style)})},getShapeStyle:function(e){var t=e.style.r||100;return M.call(this,{r:t,x:0,y:0},e)}},"base-node"),e.registerNode("ellipse-node",{shapeType:"ellipse",getShapeStyle:function(e){return M.call(this,{rx:50,ry:30,x:0,y:0},e)}},"base-node"),e.registerNode("modelRect-node",{shapeType:"rect",getShapeStyle:function(e){var t=e.style.width||200,n=e.style.height||80;return M.call(this,{width:t,height:n,radius:5,x:-t/2,y:-n/2},e)}},"base-node"),e.registerNode("diamond-node",{shapeType:"path",getShapeStyle:function(e){var t=this.getPath(e);return M.call(this,{path:t,x:0,y:0},e)},getPath:function(e){var t=e.style.size||[100,100],n=t[0],r=t[1];return[["M",0,-r/2],["L",n/2,0],["L",0,r/2],["L",-n/2,0],["Z"]]}},"base-node"),e.registerNode("triangle-node",{shapeType:"path",getShapeStyle:function(e){var t=this.getPath(e);return M.call(this,{direction:e.direction||"up",path:t,x:0,y:0},e)},getPath:function(e){var t=e.direction||"up",n=e.style.size||[60,100],r=n[0],a=n[1],o=[["Z"]];return"up"===t?o.unshift(["M",0,-a/2],["L",-r/2,0],["L",r/2,0]):o.unshift(["M",0,a/2],["L",-r/2,0],["L",r/2,0]),o},getAnchorPoints:function(e){return e.anchorPoints||[[.5,0],[0,1],[1,1]]}},"base-node")}(e)};n("L9s1");function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I=function(e){!function(e){e.registerBehavior("canvas-event",{getDefaultCfg:function(){return{}},shouldBegin:function(e){return!0},getEvents:function(){return{"canvas:mousemove":"onCanvasMouseMove","canvas:mousedown":"onCanvasMouseDown","canvas:mouseup":"onCanvasMouseUp","canvas:dragend":"onCanvasDragEnd"}},onCanvasMouseMove:function(e){e.target.get("el").style.cursor="grab"},onCanvasMouseDown:function(e){e.target.get("el").style.cursor="grabbing"},onCanvasMouseUp:function(e){e.target.get("el").style.cursor="grab"},onCanvasDragEnd:function(e){e.target.get("el").style.cursor="grab",this.graph.emit("on-canvas-dragend",e)}})}(e),function(e){e.registerBehavior("select-node",{getDefaultCfg:function(){return{multiple:!1}},getEvents:function(){return{"node:click":"onNodeClick","node:dblclick":"ondblClick","canvas:click":"onCanvasClick","node:mouseenter":"onNodeMouseEnter","node:mousemove":"onNodeMouseMove","node:mouseleave":"onNodeMouseLeave"}},shouldBegin:function(e){return!0},onNodeClick:function(e){this.shouldBegin(e)&&(this._clearSelected(),e.item.toFront(),e.item.setState("nodeState","selected"),this.graph.emit("after-node-selected",e))},ondblClick:function(e){this.shouldBegin(e)&&(this._clearSelected(),e.item.toFront(),e.item.setState("nodeState","selected"),this.graph.emit("after-node-dblclick",e))},onCanvasClick:function(e){this.shouldBegin(e)&&(this._clearSelected(),this.graph.emit("on-canvas-click",e))},onNodeMouseEnter:function(e){this.shouldBegin(e)&&(e.item.hasState("nodeState:selected")||e.item.setState("nodeState","hover"),this.graph.emit("on-node-mouseenter",e))},onNodeMouseMove:function(e){this.shouldBegin(e)&&this.graph.emit("on-node-mousemove",e)},onNodeMouseLeave:function(e){this.shouldBegin(e)&&(e.item.hasState("nodeState:selected")||e.item.clearStates("nodeState:hover"),this.graph.emit("on-node-mouseleave",e))},_clearSelected:function(){this.graph.findAllByState("node","nodeState:selected").forEach((function(e){e.clearStates(["nodeState:selected","nodeState:hover"])})),this.graph.findAllByState("edge","edgeState:selected").forEach((function(e){e.clearStates(["edgeState:selected","edgeState:hover"])})),this.graph.emit("after-node-selected")}})}(e),function(e){e.registerBehavior("delete-item",{getEvents:function(){return{keydown:"onKeydown"}},shouldBegin:function(e){return!0},onKeydown:function(e){var t=this.graph;if("true"===t.cfg.canvas.cfg.el.getAttribute("isFocused")&&this.shouldBegin(e)&&(8===e.keyCode||46===e.keyCode)){var n=t.findAllByState("node","nodeState:selected");if(n&&n.length){var r=n[0].getContainer().get("item");t.emit("before-node-removed",{target:r,callback:function(e){e&&(t.remove(r),t.set("after-node-selected",[]),t.emit("after-node-selected"),t.emit("after-node-removed",r))}})}var a=t.findAllByState("edge","edgeState:selected");if(a&&a.length){var o=a[0].getContainer().get("item");t.emit("before-edge-removed",{target:o,callback:function(e){e&&(t.remove(o),t.set("after-edge-selected",[]),t.emit("after-edge-selected"),t.emit("after-edge-removed",o))}})}}}})}(e),function(e){e.registerBehavior("active-edge",{getDefaultCfg:function(){return{}},getEvents:function(){return{"canvas:click":"onCanvasClick","edge:click":"onEdgeClick","edge:dblclick":"ondblEdgeClick","edge:mouseenter":"onMouseEnter","edge:mousemove":"onMouseMove","edge:mouseleave":"onMouseLeave"}},shouldBegin:function(e){return!0},onCanvasClick:function(e){this._clearSelected()},onEdgeClick:function(e){this.shouldBegin(e)&&(this._clearSelected(),e.item.setState("edgeState","selected"),this.graph.emit("after-edge-selected",e))},ondblEdgeClick:function(e){this.shouldBegin(e)&&(this._clearSelected(),e.item.setState("edgeState","selected"),this.graph.emit("after-edge-dblclick",e))},onMouseEnter:function(e){this.shouldBegin(e)&&(e.item.hasState("edgeState:hover")||e.item.hasState("edgeState:selected")||e.item.setState("edgeState","hover"),this.graph.emit("on-edge-mouseenter",e))},onMouseMove:function(e){this.shouldBegin(e)&&this.graph.emit("on-edge-mousemove",e)},onMouseLeave:function(e){this.shouldBegin(e)&&(e.item.hasState("edgeState:selected")||e.item.setState("edgeState","default"),this.graph.emit("on-edge-mouseleave",e))},_clearSelected:function(){this.graph.findAllByState("node","nodeState:selected").forEach((function(e){e.clearStates("nodeState:selected")})),this.graph.findAllByState("edge","edgeState:selected").forEach((function(e){e.clearStates("edgeState:selected")})),this.graph.emit("after-edge-selected")}})}(e),function(e){e.registerBehavior("hover-node",{getEvents:function(){return{"node:mouseenter":"onNodeEnter","node:mouseleave":"onNodeLeave"}},shouldBegin:function(e){return!0},onNodeEnter:function(e){this.shouldBegin(e)&&e.item.setState("anchorShow",!0)},onNodeLeave:function(e){this.shouldBegin(e)&&e.item.setState("anchorShow",!1)}})}(e),function(e){e.registerBehavior("drag-shadow-node",{getDefaultCfg:function(){return{isGragging:!1,sourceAnchorIndex:0,dragTarget:"node",dragStartNode:{},distance:[]}},getEvents:function(){return{"node:mousedown":"onMousedown","node:mouseup":"onMouseup","node:dragstart":"onDragStart","node:drag":"onDrag","node:dragend":"onDragEnd","node:drop":"onDrop"}},shouldBegin:function(e){return!0},onMousedown:function(e){if(this.shouldBegin(e)){if(this._clearSelected(e),e.target.cfg.isAnchor)this.dragTarget="anchor",this.dragStartNode=F(F({},e.item._cfg),{},{anchorIndex:e.target.cfg.index}),this.graph.findAll("node",(function(e){return e})).forEach((function(e){e.setState("anchorActived",!0)}));this.graph.emit("on-node-mousedown",e)}},onMouseup:function(e){if(this.shouldBegin(e)){if("anchor"===this.dragTarget)this.graph.findAll("node",(function(e){return e})).forEach((function(e){e.clearStates("anchorActived")}));this.graph.emit("on-node-mouseup",e)}},onDragStart:function(e){if(this.shouldBegin(e)){var t=e.item.getContainer();this.isGragging=!0,this.origin={x:e.x,y:e.y},e.target.get("isAnchor")?this.sourceAnchorIndex=e.target.get("index"):t.getFirst().cfg.xShapeNode&&(e.item.toFront(),this.dragTarget="node",this._nodeOnDragStart(e,t)),this.graph.emit("on-node-dragstart",e)}},onDrag:function(e){if(this.shouldBegin(e)&&this.isGragging){var t=e.item.getContainer();"node"===this.dragTarget&&t.getFirst().cfg.xShapeNode&&this._nodeOnDrag(e,e.item.getContainer()),this.graph.emit("on-node-drag",e)}},onDragEnd:function(e){if(this.shouldBegin(e)){var t=e.item.getContainer();if(this.isGragging=!1,"anchor"===this.dragTarget)this.graph.findAll("node",(function(e){return e})).forEach((function(e){e.clearStates("anchorActived")}));else"node"===this.dragTarget&&t.getFirst().cfg.xShapeNode&&this._nodeOnDragEnd(e,t);this.graph.emit("on-node-dragend",e)}},onDrop:function(e){var t=this;if(this.shouldBegin(e)){if(this.dragStartNode.id&&e.target.cfg.isAnchor&&this.dragStartNode.id!==e.target.cfg.nodeId){var n=this.dragStartNode.group.get("item"),r=n.getModel().singleEdge,a=e.target.get("index");n.getOutEdges().find((function(o){if(o.get("source").get("id")===n.get("id")&&o.get("target").get("id")===e.target.cfg.nodeId&&o.get("sourceAnchorIndex")===t.sourceAnchorIndex&&o.get("targetAnchorIndex")===a||r&&o.get("target").get("id")===e.target.cfg.nodeId)return!0}))||this.graph.emit("before-edge-add",{source:n,target:e.item.getContainer().get("item"),sourceAnchor:this.dragStartNode.anchorIndex,targetAnchor:e.target.cfg.index})}this.graph.emit("on-node-drop",e)}},_dragNodeModeCheck:function(){return!!this.graph.get("modes")[this.graph.getCurrentMode()].includes("drag-node")},_nodeOnDragStart:function(e,t){this._dragNodeModeCheck(),this._addShadowNode(e,t)},_addShadowNode:function(e,t){var n=t.get("item"),r=n.get("model"),a=n.get("originStyle").radius,o=n.get("currentShape"),i=n.getBBox(),s=i.width,c=i.height,d=i.centerX,l=i.centerY,h=(n.get("shapeFactory")[o]||{}).shapeType,g={fillOpacity:.1,fill:"#1890FF",stroke:"#1890FF",cursor:"move",lineDash:[4,4],width:s,height:c,x:r.x,y:r.y};switch(h){case"circle":this.distance=[e.x-d,e.y-l],g=F(F({},g),{},{r:s/2});break;case"rect":this.distance=[e.x-d+s/2,e.y-l+c/2],g=F(F({},g),{},{x:-s/2,y:-c/2,r:s/2}),a&&(g.radius=a);break;case"ellipse":this.distance=[e.x-d,e.y-l],g=F(F({},g),{},{rx:s/2,ry:c/2});break;case"path":this.distance=[e.x-d,e.y-l],g.path=n.get("keyShape").attrs.path,g.size=[s,c];break;case"modelRect":this.distance=[e.x-d+s/2,e.y-l+c/2],g=F(F({},g),{},{x:-s/2,y:-c/2,r:s/2}),h="rect";break;default:h="circle"}t.addShape(h,{className:"shadow-node",attrs:g}).toFront()},_nodeOnDrag:function(e,t){var n=t.get("item"),r=t.getFirst(),a=n.getBBox(),o=a.width,i=a.height,s=a.centerX,c=a.centerY,d=r.cfg.xShapeNode?t.$getItem("shadow-node"):null,l=(n.get("shapeFactory")[n.get("currentShape")]||{}).shapeType;if(d){if("path"===l){var h=r.get("attrs"),g=h.type,u=h.direction,f=e.x-s-this.distance[0],p=e.y-c-this.distance[1],y=[["Z"]];switch(g){case"diamond-node":y.unshift(["M",f,p-i/2],["L",f+o/2,p],["L",f,p+i/2],["L",f-o/2,p]);break;case"triangle-node":y.unshift(["L",f+o/2,p],["L",f-o/2,p]),"up"===u?y.unshift(["M",f,p-i]):y.unshift(["M",f,p+i])}d.attr({path:y})}else d.attr({x:e.x-s-this.distance[0],y:e.y-c-this.distance[1]});d.toFront()}},_nodeOnDragEnd:function(e,t){var n=this.graph,r=e.item.getModel(),a=t.getFirst().cfg.xShapeNode?t.$getItem("shadow-node"):null;if(a){var o={x:e.x-this.origin.x+r.x,y:e.y-this.origin.y+r.y};a.remove(),this._dragNodeModeCheck()||n.updateItem(e.item,o)}},_clearSelected:function(e){this.graph.findAllByState("edge","edgeState:selected").forEach((function(e){e.clearStates(["edgeState:selected","edgeState:hover"])}))}})}(e)};function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var T={ball:{run:function(e){var t=e.get("children")[0],n=t.get("endArrowShape"),r=n&&n.get("bbox")?Math.max(n.get("bbox").width,n.get("bbox").height):0,a=t.getPoint(0),o=t.getTotalLength(),i=Math.floor(o/100)||1;if(!(o<=40))for(var s=0;s<i;s++){var c=setTimeout((function(){var n=e.addShape("circle",{attrs:{x:a.x,y:a.y,fill:"#1890ff",r:2},className:"edge-runner",name:"edge-runner"});n.animate((function(e){var a=t.getPoint(e),i=o-o*e>=r?1:0;return n.set("hasChanged",!1),_(_({},a),{},{opacity:i})}),{duration:o>=100?3*o:5*o,repeat:!0})}),s*o);e.runners.push(c)}},stop:function(e){var t=[];e.get("children").forEach((function(e){"edge-runner"===e.get("className")&&(e.stopAnimate(),t.push(e))})),t.forEach((function(e){return e.remove()})),e.runners.forEach((function(e){clearTimeout(e)})),e.running=!1}},dash:{run:function(e){var t=0,n=e.get("children")[0];e.addShape("path",{attrs:{offset:n.attrs.offset,path:n.attrs.path,stroke:"#fff",startArrow:!1,endArrow:!1},name:"edge-dash"}).animate((function(e){return++t>9&&(t=0),{lineDash:[2,1,2,4],lineDashOffset:-t}}),{repeat:!0,duration:3e3})},stop:function(e){var t=e.get("children").find((function(e){return"edge-dash"===e.cfg.name}));t&&(t.remove(),e.running=!1)}}};function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function W(e,t){t.running=!1,t.runners=[];var n=Object.assign({},this.getShapeStyle(e),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.edgeStateStyles));return t.addShape("path",{className:"edge-shape",name:"edge-shape",attrs:n})}function K(e,t,n){var r=n.getContainer();r.get("destroyed")||(["edgeState","edgeState:default","edgeState:selected","edgeState:hover"].includes(e)?d[e].call(this,t,r):this.stateApplying&&this.stateApplying.call(this,e,t,n))}function V(e,t){e.running||(e.running=!0,e.toFront(),T[t].run.call(this,e))}function q(e,t){T[t].stop.call(this,e)}var Z=function(e){["line","polyline","quadratic","cubic","arc"].forEach((function(t){!function(e,t){e.registerEdge("".concat(t,"-edge"),{drawShape:W,setState:K,runAnimate:V,stopAnimate:q},t)}(e,t)})),function(e,t){e.registerEdge("hvh-edge",G({draw:function(e,t){var n=e.startPoint,r=e.endPoint,a=r.y-n.y,o={x:n.x,y:r.y},i=0===a?[["M",n.x,n.y],["L",r.x,r.y]]:[["M",n.x,n.y],["L",n.x+40,n.y],["L",o.x+40,r.y>n.y?o.y-10:o.y+10],["Q",o.x+40,o.y,o.x+40+10,o.y],["L",r.x,r.y]],s=e.sourceNode.getModel().edgeStyle,c=t.addShape("path",{attrs:G(G({path:i,stroke:"#1890FF",endArrow:!1},e.style),s),name:"hvh-edge",draggable:!0}),d=e.targetMode.getModel().note;if(d){var l=t.addShape("text",{attrs:{x:o.x+40+10,y:r.y-30,autoRotate:!0,text:d||"",fill:"#333",stroke:"#fff",fontSize:16},zIndex:10});t.sort(),l.toFront()}return c}},t))}(e,{drawShape:W,setState:K,runAnimate:V,stopAnimate:q}),function(e,t){e.registerEdge("hvh-h-edge",R({draw:function(e,t){var n=e.startPoint,r=e.endPoint,a=r.y-n.y,o={x:n.x,y:r.y},i=n.x-r.x>0,s=0===a?[["M",n.x,n.y],["L",r.x,r.y]]:[["M",n.x,n.y],["L",i?n.x-40:n.x+40,n.y],["L",i?o.x-40:o.x+40,r.y>n.y?o.y-10:o.y+10],["Q",i?o.x-40:o.x+40,o.y,i?o.x-40-10:o.x+40+10,o.y],["L",r.x,r.y]],c=e.sourceNode.getModel().edgeStyle,d=t.addShape("path",{attrs:R(R({path:s,stroke:"#1890FF",endArrow:!1},e.style),c),name:"hvh-edge",draggable:!0}),l=e.targetNode.getModel().text;if(l){var h=t.addShape("text",{attrs:{x:o.x+40+10,y:r.y-30,text:l||"",fill:"#333",fontSize:16},name:"hvh-edge-label",zIndex:10});t.sort(),h.toFront()}return d}},t))}(e,{drawShape:W,setState:K,runAnimate:V,stopAnimate:q})};t.a=function(e,t){var n=Object.assign({container:"canvasPanel",width:window.innerWidth,height:window.innerHeight,fitViewPadding:20,animate:!0,animateCfg:{duration:500,easing:"easeLinear"},layout:{type:"dagre",nodesep:30,ranksep:30},modes:{default:["drag-canvas","canvas-event","delete-item","select-node","hover-node","drag-shadow-node","active-edge"]},defaultNode:{type:"rect-node",style:{radius:10}},defaultEdge:{type:"polyline-edge",style:{radius:6,offset:15,stroke:"#aab7c3",lineAppendWidth:10,endArrow:{path:"M 0,0 L 8,4 L 7,0 L 8,-4 Z",fill:"#aab7c3",stroke:"#aab7c3"}}},nodeStateStyles:{"nodeState:default":{fill:"#E7F7FE",stroke:"#1890FF"},"nodeState:hover":{fill:"#d5f1fd"},"nodeState:selected":{fill:"#caebf9",stroke:"#1890FF"}},edgeStateStyles:{"edgeState:default":{stroke:"#aab7c3",endArrow:{path:"M 0,0 L 8,4 L 7,0 L 8,-4 Z",fill:"#aab7c3",stroke:"#aab7c3"}},"edgeState:selected":{stroke:"#1890FF"},"edgeState:hover":{stroke:"#1890FF"}}},t),r="string"==typeof n.container?document.getElementById(n.container):n.container;return r&&(setTimeout((function(){for(var e=function(e){var t=r.children[e];if("CANVAS"===t.nodeName)return t.$id="".concat(n.container,"-canvas"),document.addEventListener("click",(function(e){t.setAttribute("isFocused",e.target.$id===t.$id)})),"break"},t=0;t<r.children.length;t++){if("break"===e(t))break}})),function(e){D(e),I(e),Z(e)}(e)),n}}}]);