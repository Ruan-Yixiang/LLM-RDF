{"remainingRequest":"F:\\fGPT\\foundryGPT\\frontend\\node_modules\\babel-loader\\lib\\index.js!F:\\fGPT\\foundryGPT\\frontend\\src\\components\\graph\\shape\\items\\anchor-event.js","dependencies":[{"path":"F:\\fGPT\\foundryGPT\\frontend\\src\\components\\graph\\shape\\items\\anchor-event.js","mtime":1687233680000},{"path":"F:\\fGPT\\foundryGPT\\frontend\\babel.config.js","mtime":1645975642000},{"path":"F:\\fGPT\\foundryGPT\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\fGPT\\foundryGPT\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJGOi9mR1BUL2ZvdW5kcnlHUFQvZnJvbnRlbmQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3RvQ29uc3VtYWJsZUFycmF5LmpzIjsKdmFyIGRyYWdMb2cgPSBbXSwKICBhbmNob3JOb2RlSWQgPSBudWxsOwpleHBvcnQgZGVmYXVsdCAoZnVuY3Rpb24gKGFuY2hvciwgZ3JvdXAsIHApIHsKICBhbmNob3Iub24oJ21vdXNlZW50ZXInLCBmdW5jdGlvbiAoKSB7CiAgICBhbmNob3IuYXR0cih7CiAgICAgIGN1cnNvcjogJ2Nyb3NzaGFpcicKICAgIH0pOwogIH0pOwogIGFuY2hvci5vbignZHJhZ3N0YXJ0JywgZnVuY3Rpb24gKGUpIHsKICAgIGlmIChhbmNob3JOb2RlSWQgPT0gbnVsbCkgewogICAgICB2YXIgX2dyb3VwJGdldEZpcnN0JGF0dHIgPSBncm91cC5nZXRGaXJzdCgpLmF0dHIoKSwKICAgICAgICB0eXBlID0gX2dyb3VwJGdldEZpcnN0JGF0dHIudHlwZSwKICAgICAgICBkaXJlY3Rpb24gPSBfZ3JvdXAkZ2V0Rmlyc3QkYXR0ci5kaXJlY3Rpb247CiAgICAgIHZhciBkaWZmID0gdHlwZSA9PT0gJ3RyaWFuZ2xlLW5vZGUnID8gZGlyZWN0aW9uID09PSAndXAnID8gMSA6IDAgOiAwLjU7CiAgICAgIHZhciBiQm94ID0gZ3JvdXAuZ2V0KCdpdGVtJykuZ2V0QkJveCgpOwogICAgICB2YXIgaWQgPSBncm91cC5nZXQoJ2l0ZW0nKS5nZXQoJ2lkJyk7CiAgICAgIHZhciBwb2ludCA9IFtiQm94LndpZHRoICogKHBbMF0gLSAwLjUpLAogICAgICAvLyB4CiAgICAgIGJCb3guaGVpZ2h0ICogKHBbMV0gLSBkaWZmKSAvLyB5CiAgICAgIF07CgogICAgICBkcmFnTG9nID0gW2UueCwgZS55XTsKICAgICAgdmFyIGxpbmUgPSBncm91cC5hZGRTaGFwZSgncGF0aCcsIHsKICAgICAgICBhdHRyczogewogICAgICAgICAgc3Ryb2tlOiAnIzE4OTBGRicsCiAgICAgICAgICBsaW5lRGFzaDogWzUsIDVdLAogICAgICAgICAgcGF0aDogW1snTSddLmNvbmNhdChwb2ludCksIFsnTCddLmNvbmNhdChwb2ludCldCiAgICAgICAgfSwKICAgICAgICBjbGFzc05hbWU6ICdkYXNoZWQtbGluZScsCiAgICAgICAgcG9pbnRTdGFydDogcG9pbnQKICAgICAgfSk7CiAgICAgIGdyb3VwLnRvRnJvbnQoKTsKICAgICAgbGluZS50b0Zyb250KCk7CiAgICAgIGFuY2hvck5vZGVJZCA9IGlkOwogICAgfQogIH0pOwogIGFuY2hvci5vbignZHJhZycsIGZ1bmN0aW9uIChlKSB7CiAgICB2YXIgX2dyb3VwJGdldEZpcnN0JGF0dHIyID0gZ3JvdXAuZ2V0Rmlyc3QoKS5hdHRyKCksCiAgICAgIHR5cGUgPSBfZ3JvdXAkZ2V0Rmlyc3QkYXR0cjIudHlwZSwKICAgICAgZGlyZWN0aW9uID0gX2dyb3VwJGdldEZpcnN0JGF0dHIyLmRpcmVjdGlvbjsKICAgIHZhciBjYW52YXNCb3ggPSBncm91cC5nZXQoJ2NoaWxkcmVuJylbMF0uZ2V0KCdjYW52YXNCQm94Jyk7CiAgICBpZiAoIWNhbnZhc0JveCkgcmV0dXJuOwogICAgdmFyIGRpZmYgPSB0eXBlID09PSAndHJpYW5nbGUtbm9kZScgPyBkaXJlY3Rpb24gPT09ICd1cCcgPyBjYW52YXNCb3guaGVpZ2h0IDogMCA6IGNhbnZhc0JveC5oZWlnaHQgLyAyOwogICAgdmFyIGxpbmUgPSBncm91cC4kZ2V0SXRlbSgnZGFzaGVkLWxpbmUnKTsKICAgIHZhciBwb2ludFN0YXJ0ID0gbGluZS5nZXQoJ3BvaW50U3RhcnQnKTsKICAgIHZhciBlbmRQb2ludCA9IFtlLnggLSBjYW52YXNCb3gueCAtIGNhbnZhc0JveC53aWR0aCAvIDIsIGUueSAtIGNhbnZhc0JveC55IC0gZGlmZl07CiAgICBsaW5lLnRvRnJvbnQoKTsKICAgIGlmIChNYXRoLnNxcnQoTWF0aC5wb3coTWF0aC5hYnMoZHJhZ0xvZ1swXSkgLSBNYXRoLmFicyhlLngpLCAyKSArIE1hdGgucG93KE1hdGguYWJzKGRyYWdMb2dbMV0pIC0gTWF0aC5hYnMoZS55KSwgMikpID49IDEwKSB7CiAgICAgIGlmIChlLnggPj0gZHJhZ0xvZ1swXSkgewogICAgICAgIGlmIChlLnkgPj0gZHJhZ0xvZ1sxXSkgewogICAgICAgICAgZW5kUG9pbnRbMF0gLT0gMTsKICAgICAgICAgIGVuZFBvaW50WzFdIC09IDE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGVuZFBvaW50WzBdIC09IDE7CiAgICAgICAgICBlbmRQb2ludFsxXSAtPSAxOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoZS55ID49IGRyYWdMb2dbMV0pIHsKICAgICAgICAgIGVuZFBvaW50WzBdICs9IDE7CiAgICAgICAgICBlbmRQb2ludFsxXSArPSAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBlbmRQb2ludFswXSArPSAxOwogICAgICAgICAgZW5kUG9pbnRbMV0gKz0gMTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIGxpbmUuYXR0cih7CiAgICAgIHBhdGg6IFtbJ00nXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KHBvaW50U3RhcnQpKSwgWydMJywgZW5kUG9pbnRbMF0sIGVuZFBvaW50WzFdXV0KICAgIH0pOwogIH0pOwogIGFuY2hvci5vbignZHJhZ2VuZCcsIGZ1bmN0aW9uIChlKSB7CiAgICB2YXIgaXRlbSA9IGdyb3VwLiRnZXRJdGVtKCdkYXNoZWQtbGluZScpOwogICAgaXRlbS5yZW1vdmUoKTsKICAgIGFuY2hvck5vZGVJZCA9IG51bGw7CiAgfSk7CiAgYW5jaG9yLm9uKCdkcmFnZW50ZXInLCBmdW5jdGlvbiAoZSkgewogICAgaWYgKGUudGFyZ2V0LmNmZy5ub2RlSWQgIT09IGFuY2hvck5vZGVJZCkgewogICAgICB2YXIgaW5kZXggPSBlLnRhcmdldC5jZmcuaW5kZXg7CiAgICAgIGlmIChncm91cC5nZXRBbGxBbmNob3JCZygpW2luZGV4XSkgewogICAgICAgIGdyb3VwLmdldEFsbEFuY2hvckJnKClbaW5kZXhdLmF0dHIoJ2ZpbGxPcGFjaXR5JywgMC43KTsKICAgICAgfQogICAgfQogIH0pOwogIGFuY2hvci5vbignZHJhZ2xlYXZlJywgZnVuY3Rpb24gKGUpIHsKICAgIGlmIChlLnRhcmdldC5jZmcubm9kZUlkICE9PSBhbmNob3JOb2RlSWQpIHsKICAgICAgdmFyIGluZGV4ID0gZS50YXJnZXQuY2ZnLmluZGV4OwogICAgICBpZiAoZ3JvdXAuZ2V0QWxsQW5jaG9yQmcoKVtpbmRleF0pIHsKICAgICAgICBncm91cC5nZXRBbGxBbmNob3JCZygpW2luZGV4XS5hdHRyKCdmaWxsT3BhY2l0eScsIDAuNSk7CiAgICAgIH0KICAgIH0KICB9KTsKfSk7"},{"version":3,"names":["dragLog","anchorNodeId","anchor","group","p","on","attr","cursor","e","_group$getFirst$attr","getFirst","type","direction","diff","bBox","get","getBBox","id","point","width","height","x","y","line","addShape","attrs","stroke","lineDash","path","concat","className","pointStart","toFront","_group$getFirst$attr2","canvasBox","$getItem","endPoint","Math","sqrt","pow","abs","_toConsumableArray","item","remove","target","cfg","nodeId","index","getAllAnchorBg"],"sources":["F:/fGPT/foundryGPT/frontend/src/components/graph/shape/items/anchor-event.js"],"sourcesContent":["\r\nlet dragLog = [], \r\nanchorNodeId = null; \r\n\r\nexport default (anchor, group, p) => {\r\n\r\n  anchor.on('mouseenter', () => {\r\n\r\n    anchor.attr({\r\n      cursor: 'crosshair',\r\n    });\r\n  });\r\n\r\n  anchor.on('dragstart', e => {\r\n    if (anchorNodeId == null) {\r\n      const { type, direction } = group.getFirst().attr();\r\n      const diff = type === 'triangle-node' ? (direction === 'up' ? 1 : 0) : 0.5;\r\n      const bBox = group.get('item').getBBox();\r\n      const id = group.get('item').get('id');\r\n      const point = [\r\n        bBox.width * (p[0] - 0.5), // x\r\n        bBox.height * (p[1] - diff), // y\r\n      ];\r\n\r\n      dragLog = [e.x, e.y];\r\n\r\n      const line = group.addShape('path', {\r\n        attrs: {\r\n          stroke:   '#1890FF',\r\n          lineDash: [5, 5],\r\n          path:     [\r\n            ['M', ...point],\r\n            ['L', ...point],\r\n          ],\r\n        },\r\n        className:  'dashed-line',\r\n        pointStart: point,\r\n      });\r\n\r\n\r\n      group.toFront();\r\n      line.toFront();\r\n      anchorNodeId = id;\r\n    }\r\n  });\r\n\r\n\r\n  anchor.on('drag', e => {\r\n    const { type, direction } = group.getFirst().attr();\r\n    const canvasBox = group.get('children')[0].get('canvasBBox');\r\n\r\n    if (!canvasBox) return;\r\n\r\n    const diff = type === 'triangle-node' ? (direction === 'up' ? canvasBox.height : 0) : canvasBox.height / 2;\r\n    const line = group.$getItem('dashed-line');\r\n    const pointStart = line.get('pointStart');\r\n    const endPoint = [e.x - canvasBox.x - canvasBox.width / 2, e.y - canvasBox.y - diff];\r\n\r\n    line.toFront();\r\n\r\n    \r\n    if (Math.sqrt(Math.pow(Math.abs(dragLog[0]) - Math.abs(e.x), 2) + Math.pow(Math.abs(dragLog[1]) - Math.abs(e.y), 2)) >= 10) {\r\n      if (e.x >= dragLog[0]) {\r\n\r\n        if (e.y >= dragLog[1]) {\r\n          endPoint[0] -= 1;\r\n          endPoint[1] -= 1;\r\n        } else {\r\n\r\n          endPoint[0] -= 1;\r\n          endPoint[1] -= 1;\r\n        }\r\n      } else {\r\n\r\n        if (e.y >= dragLog[1]) {\r\n          endPoint[0] += 1;\r\n          endPoint[1] += 1;\r\n        } else {\r\n\r\n          endPoint[0] += 1;\r\n          endPoint[1] += 1;\r\n        }\r\n      }\r\n    }\r\n\r\n    line.attr({\r\n      path: [\r\n        ['M', ...pointStart],\r\n        ['L', endPoint[0], endPoint[1]],\r\n      ],\r\n    });\r\n  });\r\n\r\n\r\n  anchor.on('dragend', e => {\r\n    const item = group.$getItem('dashed-line');\r\n\r\n    item.remove();\r\n    anchorNodeId = null;\r\n  });\r\n\r\n\r\n  anchor.on('dragenter', e => {\r\n\r\n    if (e.target.cfg.nodeId !== anchorNodeId) {\r\n      const { index } = e.target.cfg;\r\n\r\n      if (group.getAllAnchorBg()[index]) {\r\n        group.getAllAnchorBg()[index].attr('fillOpacity', 0.7);\r\n      }\r\n    }\r\n  });\r\n\r\n\r\n  anchor.on('dragleave', e => {\r\n\r\n    if (e.target.cfg.nodeId !== anchorNodeId) {\r\n      const { index } = e.target.cfg;\r\n\r\n      if (group.getAllAnchorBg()[index]) {\r\n        group.getAllAnchorBg()[index].attr('fillOpacity', 0.5);\r\n      }\r\n    }\r\n  });\r\n\r\n\r\n};\r\n"],"mappings":"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"}]}