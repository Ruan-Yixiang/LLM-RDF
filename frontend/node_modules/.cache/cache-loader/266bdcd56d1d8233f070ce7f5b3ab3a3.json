{"remainingRequest":"D:\\develop_ryx\\foundryGPT\\frontend\\node_modules\\babel-loader\\lib\\index.js!D:\\develop_ryx\\foundryGPT\\frontend\\src\\components\\graph\\shape\\items\\anchor-event.js","dependencies":[{"path":"D:\\develop_ryx\\foundryGPT\\frontend\\src\\components\\graph\\shape\\items\\anchor-event.js","mtime":1687233680000},{"path":"D:\\develop_ryx\\foundryGPT\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\develop_ryx\\foundryGPT\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:bGV0IGRyYWdMb2cgPSBbXSwKICBhbmNob3JOb2RlSWQgPSBudWxsOwpleHBvcnQgZGVmYXVsdCAoKGFuY2hvciwgZ3JvdXAsIHApID0+IHsKICBhbmNob3Iub24oJ21vdXNlZW50ZXInLCAoKSA9PiB7CiAgICBhbmNob3IuYXR0cih7CiAgICAgIGN1cnNvcjogJ2Nyb3NzaGFpcicKICAgIH0pOwogIH0pOwogIGFuY2hvci5vbignZHJhZ3N0YXJ0JywgZSA9PiB7CiAgICBpZiAoYW5jaG9yTm9kZUlkID09IG51bGwpIHsKICAgICAgY29uc3QgewogICAgICAgIHR5cGUsCiAgICAgICAgZGlyZWN0aW9uCiAgICAgIH0gPSBncm91cC5nZXRGaXJzdCgpLmF0dHIoKTsKICAgICAgY29uc3QgZGlmZiA9IHR5cGUgPT09ICd0cmlhbmdsZS1ub2RlJyA/IGRpcmVjdGlvbiA9PT0gJ3VwJyA/IDEgOiAwIDogMC41OwogICAgICBjb25zdCBiQm94ID0gZ3JvdXAuZ2V0KCdpdGVtJykuZ2V0QkJveCgpOwogICAgICBjb25zdCBpZCA9IGdyb3VwLmdldCgnaXRlbScpLmdldCgnaWQnKTsKICAgICAgY29uc3QgcG9pbnQgPSBbYkJveC53aWR0aCAqIChwWzBdIC0gMC41KSwKICAgICAgLy8geAogICAgICBiQm94LmhlaWdodCAqIChwWzFdIC0gZGlmZikgLy8geQogICAgICBdOwoKICAgICAgZHJhZ0xvZyA9IFtlLngsIGUueV07CiAgICAgIGNvbnN0IGxpbmUgPSBncm91cC5hZGRTaGFwZSgncGF0aCcsIHsKICAgICAgICBhdHRyczogewogICAgICAgICAgc3Ryb2tlOiAnIzE4OTBGRicsCiAgICAgICAgICBsaW5lRGFzaDogWzUsIDVdLAogICAgICAgICAgcGF0aDogW1snTScsIC4uLnBvaW50XSwgWydMJywgLi4ucG9pbnRdXQogICAgICAgIH0sCiAgICAgICAgY2xhc3NOYW1lOiAnZGFzaGVkLWxpbmUnLAogICAgICAgIHBvaW50U3RhcnQ6IHBvaW50CiAgICAgIH0pOwogICAgICBncm91cC50b0Zyb250KCk7CiAgICAgIGxpbmUudG9Gcm9udCgpOwogICAgICBhbmNob3JOb2RlSWQgPSBpZDsKICAgIH0KICB9KTsKICBhbmNob3Iub24oJ2RyYWcnLCBlID0+IHsKICAgIGNvbnN0IHsKICAgICAgdHlwZSwKICAgICAgZGlyZWN0aW9uCiAgICB9ID0gZ3JvdXAuZ2V0Rmlyc3QoKS5hdHRyKCk7CiAgICBjb25zdCBjYW52YXNCb3ggPSBncm91cC5nZXQoJ2NoaWxkcmVuJylbMF0uZ2V0KCdjYW52YXNCQm94Jyk7CiAgICBpZiAoIWNhbnZhc0JveCkgcmV0dXJuOwogICAgY29uc3QgZGlmZiA9IHR5cGUgPT09ICd0cmlhbmdsZS1ub2RlJyA/IGRpcmVjdGlvbiA9PT0gJ3VwJyA/IGNhbnZhc0JveC5oZWlnaHQgOiAwIDogY2FudmFzQm94LmhlaWdodCAvIDI7CiAgICBjb25zdCBsaW5lID0gZ3JvdXAuJGdldEl0ZW0oJ2Rhc2hlZC1saW5lJyk7CiAgICBjb25zdCBwb2ludFN0YXJ0ID0gbGluZS5nZXQoJ3BvaW50U3RhcnQnKTsKICAgIGNvbnN0IGVuZFBvaW50ID0gW2UueCAtIGNhbnZhc0JveC54IC0gY2FudmFzQm94LndpZHRoIC8gMiwgZS55IC0gY2FudmFzQm94LnkgLSBkaWZmXTsKICAgIGxpbmUudG9Gcm9udCgpOwogICAgaWYgKE1hdGguc3FydChNYXRoLnBvdyhNYXRoLmFicyhkcmFnTG9nWzBdKSAtIE1hdGguYWJzKGUueCksIDIpICsgTWF0aC5wb3coTWF0aC5hYnMoZHJhZ0xvZ1sxXSkgLSBNYXRoLmFicyhlLnkpLCAyKSkgPj0gMTApIHsKICAgICAgaWYgKGUueCA+PSBkcmFnTG9nWzBdKSB7CiAgICAgICAgaWYgKGUueSA+PSBkcmFnTG9nWzFdKSB7CiAgICAgICAgICBlbmRQb2ludFswXSAtPSAxOwogICAgICAgICAgZW5kUG9pbnRbMV0gLT0gMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZW5kUG9pbnRbMF0gLT0gMTsKICAgICAgICAgIGVuZFBvaW50WzFdIC09IDE7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmIChlLnkgPj0gZHJhZ0xvZ1sxXSkgewogICAgICAgICAgZW5kUG9pbnRbMF0gKz0gMTsKICAgICAgICAgIGVuZFBvaW50WzFdICs9IDE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGVuZFBvaW50WzBdICs9IDE7CiAgICAgICAgICBlbmRQb2ludFsxXSArPSAxOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgbGluZS5hdHRyKHsKICAgICAgcGF0aDogW1snTScsIC4uLnBvaW50U3RhcnRdLCBbJ0wnLCBlbmRQb2ludFswXSwgZW5kUG9pbnRbMV1dXQogICAgfSk7CiAgfSk7CiAgYW5jaG9yLm9uKCdkcmFnZW5kJywgZSA9PiB7CiAgICBjb25zdCBpdGVtID0gZ3JvdXAuJGdldEl0ZW0oJ2Rhc2hlZC1saW5lJyk7CiAgICBpdGVtLnJlbW92ZSgpOwogICAgYW5jaG9yTm9kZUlkID0gbnVsbDsKICB9KTsKICBhbmNob3Iub24oJ2RyYWdlbnRlcicsIGUgPT4gewogICAgaWYgKGUudGFyZ2V0LmNmZy5ub2RlSWQgIT09IGFuY2hvck5vZGVJZCkgewogICAgICBjb25zdCB7CiAgICAgICAgaW5kZXgKICAgICAgfSA9IGUudGFyZ2V0LmNmZzsKICAgICAgaWYgKGdyb3VwLmdldEFsbEFuY2hvckJnKClbaW5kZXhdKSB7CiAgICAgICAgZ3JvdXAuZ2V0QWxsQW5jaG9yQmcoKVtpbmRleF0uYXR0cignZmlsbE9wYWNpdHknLCAwLjcpOwogICAgICB9CiAgICB9CiAgfSk7CiAgYW5jaG9yLm9uKCdkcmFnbGVhdmUnLCBlID0+IHsKICAgIGlmIChlLnRhcmdldC5jZmcubm9kZUlkICE9PSBhbmNob3JOb2RlSWQpIHsKICAgICAgY29uc3QgewogICAgICAgIGluZGV4CiAgICAgIH0gPSBlLnRhcmdldC5jZmc7CiAgICAgIGlmIChncm91cC5nZXRBbGxBbmNob3JCZygpW2luZGV4XSkgewogICAgICAgIGdyb3VwLmdldEFsbEFuY2hvckJnKClbaW5kZXhdLmF0dHIoJ2ZpbGxPcGFjaXR5JywgMC41KTsKICAgICAgfQogICAgfQogIH0pOwp9KTs="},{"version":3,"names":["dragLog","anchorNodeId","anchor","group","p","on","attr","cursor","e","type","direction","getFirst","diff","bBox","get","getBBox","id","point","width","height","x","y","line","addShape","attrs","stroke","lineDash","path","className","pointStart","toFront","canvasBox","$getItem","endPoint","Math","sqrt","pow","abs","item","remove","target","cfg","nodeId","index","getAllAnchorBg"],"sources":["D:/develop_ryx/foundryGPT/frontend/src/components/graph/shape/items/anchor-event.js"],"sourcesContent":["\r\nlet dragLog = [], \r\nanchorNodeId = null; \r\n\r\nexport default (anchor, group, p) => {\r\n\r\n  anchor.on('mouseenter', () => {\r\n\r\n    anchor.attr({\r\n      cursor: 'crosshair',\r\n    });\r\n  });\r\n\r\n  anchor.on('dragstart', e => {\r\n    if (anchorNodeId == null) {\r\n      const { type, direction } = group.getFirst().attr();\r\n      const diff = type === 'triangle-node' ? (direction === 'up' ? 1 : 0) : 0.5;\r\n      const bBox = group.get('item').getBBox();\r\n      const id = group.get('item').get('id');\r\n      const point = [\r\n        bBox.width * (p[0] - 0.5), // x\r\n        bBox.height * (p[1] - diff), // y\r\n      ];\r\n\r\n      dragLog = [e.x, e.y];\r\n\r\n      const line = group.addShape('path', {\r\n        attrs: {\r\n          stroke:   '#1890FF',\r\n          lineDash: [5, 5],\r\n          path:     [\r\n            ['M', ...point],\r\n            ['L', ...point],\r\n          ],\r\n        },\r\n        className:  'dashed-line',\r\n        pointStart: point,\r\n      });\r\n\r\n\r\n      group.toFront();\r\n      line.toFront();\r\n      anchorNodeId = id;\r\n    }\r\n  });\r\n\r\n\r\n  anchor.on('drag', e => {\r\n    const { type, direction } = group.getFirst().attr();\r\n    const canvasBox = group.get('children')[0].get('canvasBBox');\r\n\r\n    if (!canvasBox) return;\r\n\r\n    const diff = type === 'triangle-node' ? (direction === 'up' ? canvasBox.height : 0) : canvasBox.height / 2;\r\n    const line = group.$getItem('dashed-line');\r\n    const pointStart = line.get('pointStart');\r\n    const endPoint = [e.x - canvasBox.x - canvasBox.width / 2, e.y - canvasBox.y - diff];\r\n\r\n    line.toFront();\r\n\r\n    \r\n    if (Math.sqrt(Math.pow(Math.abs(dragLog[0]) - Math.abs(e.x), 2) + Math.pow(Math.abs(dragLog[1]) - Math.abs(e.y), 2)) >= 10) {\r\n      if (e.x >= dragLog[0]) {\r\n\r\n        if (e.y >= dragLog[1]) {\r\n          endPoint[0] -= 1;\r\n          endPoint[1] -= 1;\r\n        } else {\r\n\r\n          endPoint[0] -= 1;\r\n          endPoint[1] -= 1;\r\n        }\r\n      } else {\r\n\r\n        if (e.y >= dragLog[1]) {\r\n          endPoint[0] += 1;\r\n          endPoint[1] += 1;\r\n        } else {\r\n\r\n          endPoint[0] += 1;\r\n          endPoint[1] += 1;\r\n        }\r\n      }\r\n    }\r\n\r\n    line.attr({\r\n      path: [\r\n        ['M', ...pointStart],\r\n        ['L', endPoint[0], endPoint[1]],\r\n      ],\r\n    });\r\n  });\r\n\r\n\r\n  anchor.on('dragend', e => {\r\n    const item = group.$getItem('dashed-line');\r\n\r\n    item.remove();\r\n    anchorNodeId = null;\r\n  });\r\n\r\n\r\n  anchor.on('dragenter', e => {\r\n\r\n    if (e.target.cfg.nodeId !== anchorNodeId) {\r\n      const { index } = e.target.cfg;\r\n\r\n      if (group.getAllAnchorBg()[index]) {\r\n        group.getAllAnchorBg()[index].attr('fillOpacity', 0.7);\r\n      }\r\n    }\r\n  });\r\n\r\n\r\n  anchor.on('dragleave', e => {\r\n\r\n    if (e.target.cfg.nodeId !== anchorNodeId) {\r\n      const { index } = e.target.cfg;\r\n\r\n      if (group.getAllAnchorBg()[index]) {\r\n        group.getAllAnchorBg()[index].attr('fillOpacity', 0.5);\r\n      }\r\n    }\r\n  });\r\n\r\n\r\n};\r\n"],"mappings":"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"}]}