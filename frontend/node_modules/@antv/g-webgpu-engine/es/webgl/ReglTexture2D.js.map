{"version":3,"file":"ReglTexture2D.js","names":["gl","colorSpaceMap","dataTypeMap","filterMap","formatMap","mipmapMap","wrapModeMap","ReglTexture2D","reGl","options","texture","width","height","data","type","UNSIGNED_BYTE","flipY","format","RGBA","mipmap","wrapS","CLAMP_TO_EDGE","wrapT","aniso","alignment","premultiplyAlpha","mag","NEAREST","min","colorSpace","BROWSER_DEFAULT_WEBGL","textureOptions","_texture","bind","resize","destroy"],"sources":["../../src/webgl/ReglTexture2D.ts"],"sourcesContent":["import {\n  gl,\n  ITexture2D,\n  ITexture2DInitializationOptions,\n} from '@antv/g-webgpu-core';\nimport regl from 'regl';\nimport {\n  colorSpaceMap,\n  dataTypeMap,\n  filterMap,\n  formatMap,\n  mipmapMap,\n  wrapModeMap,\n} from './constants';\n\n/**\n * adaptor for regl.Buffer\n * @see https://github.com/regl-project/regl/blob/gh-pages/API.md#buffers\n */\nexport default class ReglTexture2D implements ITexture2D {\n  private texture: regl.Texture2D;\n  private width: number;\n  private height: number;\n\n  constructor(reGl: regl.Regl, options: ITexture2DInitializationOptions) {\n    const {\n      data,\n      type = gl.UNSIGNED_BYTE,\n      width,\n      height,\n      flipY = false,\n      format = gl.RGBA,\n      mipmap = false,\n      wrapS = gl.CLAMP_TO_EDGE,\n      wrapT = gl.CLAMP_TO_EDGE,\n      aniso = 0,\n      alignment = 1,\n      premultiplyAlpha = false,\n      mag = gl.NEAREST,\n      min = gl.NEAREST,\n      colorSpace = gl.BROWSER_DEFAULT_WEBGL,\n    } = options;\n    this.width = width;\n    this.height = height;\n\n    const textureOptions: regl.Texture2DOptions = {\n      width,\n      height,\n      // @ts-ignore\n      type: dataTypeMap[type],\n      format: formatMap[format],\n      wrapS: wrapModeMap[wrapS],\n      wrapT: wrapModeMap[wrapT],\n      // @ts-ignore\n      mag: filterMap[mag],\n      min: filterMap[min],\n      alignment,\n      flipY,\n      colorSpace: colorSpaceMap[colorSpace],\n      premultiplyAlpha,\n      aniso,\n    };\n\n    if (data) {\n      textureOptions.data = data;\n    }\n\n    if (typeof mipmap === 'number') {\n      textureOptions.mipmap = mipmapMap[mipmap];\n    } else if (typeof mipmap === 'boolean') {\n      textureOptions.mipmap = mipmap;\n    }\n\n    this.texture = reGl.texture(textureOptions);\n  }\n\n  public get() {\n    return this.texture;\n  }\n  public update() {\n    // @ts-ignore\n    this.texture._texture.bind();\n  }\n\n  public resize({ width, height }: { width: number; height: number }): void {\n    this.texture.resize(width, height);\n    this.width = width;\n    this.height = height;\n  }\n\n  public destroy() {\n    this.texture.destroy();\n  }\n}\n"],"mappings":"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"}